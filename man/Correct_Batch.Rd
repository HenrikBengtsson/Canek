% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Batch_Correction.R
\name{Correct_Batch}
\alias{Correct_Batch}
\title{Correct_Batch}
\usage{
Correct_Batch(
  Reference_Batch,
  Query_Batch,
  Query_Batch_Cell_Types = "Surprise-me",
  Num_Clusters = NULL,
  Sampling = NULL,
  Number_Samples = NULL,
  Pairs = NULL,
  Cells_Index_Query = NULL,
  Cells_Index_Reference = NULL,
  k_Neighbors = 30,
  PCA = TRUE,
  Dimensions = 50,
  Max_Membership = 5,
  Fuzzy = TRUE,
  Verbose = FALSE,
  Cosine_Norm = TRUE,
  Estimation = "Average",
  FilterPairs = FALSE,
  perCellMNN = 0.08
)
}
\arguments{
\item{Reference_Batch}{Batch to use as reference for the integration.}

\item{Query_Batch}{Batch to correct.}

\item{Query_Batch_Cell_Types}{A number indicating the expected number of cells types on the batches to integrate. The default value is set as a string "Surprise-me" on which an estimation of the cell types is defined.}

\item{Num_Clusters}{Number of clusters used to filter MNNs pairs.}

\item{Sampling}{Whether or not samples MNNs pairs' samples are used on the estimation process.}

\item{Number_Samples}{Number of MNNs pairs' samples used on the estimation process.}

\item{Pairs}{A matrix containing MNNs pairs. First column corresponds to query-batch cell indexes.}

\item{Cells_Index_Query}{Index of cells from the query-batch used as observations of the batch-effect.}

\item{Cells_Index_Reference}{Index of cells from the reference-batch used as observations of the batch-effect.}

\item{k_Neighbors}{Number of k-nearest-neighbors used to find MNNs pairs.}

\item{PCA}{Whether or not MNNs pairs are found under a principal components representation.}

\item{Dimensions}{PCA dimensions used to find MNNs pairs.}

\item{Max_Membership}{Maximum number of memberships used when memberships are automatically defined.}

\item{Fuzzy}{Whether or not a fuzzy logic join is used on the local correction vectors.}

\item{Verbose}{Print output}

\item{Cosine_Norm}{TODO}

\item{Estimation}{TODO}

\item{Gain}{TODO}
}
\value{
A list containing the corrected batch as a matrix and correction data
}
\description{
Function to correct batch effect over two batches
}
\details{
Canek, a new non-linear/linear hybrid method for batch-effect correction that couples identification of similar cells
 between datasets using Mutual Nearest Neighbors (MNNs) with an Extended Kalman Filter (EKF).

 A non-linear correction is performed by using fuzzy logic to join a set of linear correction vectors which are cell-type locally estimated.
}
\examples{
x <- SimBatches$batches[[1]]
y <- SimBatches$batches[[2]]
z <- Canek:::Correct_Batch(x,y)
Corrected <- z$`Corrected Query Batch`

Uncorrected_PCA <- prcomp(t(cbind(x,y)))
plot(Uncorrected_PCA$x[,1:2])
Corrected_PCA <- prcomp(t(cbind(x,z$`Corrected Query Batch`)))
plot(Corrected_PCA$x[,1:2])

}

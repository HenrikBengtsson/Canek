% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Batch_Correction.R
\name{Correct_Batches}
\alias{Correct_Batches}
\title{Correct_Batches}
\usage{
Correct_Batches(
  Batches,
  queNumCelltypes = NULL,
  Sampling = NULL,
  Number_Samples = NULL,
  k_Neighbors = 30,
  Dimensions = 50,
  Max_Membership = 5,
  Fuzzy = TRUE,
  Hierarchical = TRUE,
  Verbose = FALSE,
  Estimation = "Median",
  FilterPairs = FALSE,
  perCellMNN = 0.08,
  ...
)
}
\arguments{
\item{Batches}{List of batches to integrate. Batches should contain the same number of genes as rows.}

\item{queNumCelltypes}{A number indicating the expected number of cells types on the batches to integrate. The default value is set as a string "Surprise-me" on which an estimation of the cell types is defined.}

\item{Sampling}{Whether or not sampling of MNNs pairs is used on the estimation process.}

\item{Number_Samples}{Number of MNNs pairs samples used on the estimation process.}

\item{k_Neighbors}{Number of k-nearest-neighbors used to find MNNs pairs.}

\item{Dimensions}{PCA dimensions used to find MNNs pairs.}

\item{Max_Membership}{Maximum number of memberships used when memberships are automatically defined.}

\item{Fuzzy}{Whether or not a fuzzy logic join is used on the local correction vectors.}

\item{Hierarchical}{Whether or not a hiearchical integration scheme is used when correcting more than two batches.}

\item{Verbose}{Print output}

\item{Estimation}{TODO}

\item{FilterPairs}{whether to perform pair filtering (default: FALSE)}

\item{perCellMNN}{TODO}

\item{...}{pass down methods from RunCanek().}
}
\value{
A list containing the integrated datasets as matrix and the correction data .
}
\description{
Batch-Effect correction over a list of single cell batches
}
\details{
Correct_Batches is non-linear/linear hybrid method for single-cell batch-effect correction that couples identification of similar cells
 between datasets using Mutual Nearest Neighbors (MNNs) with an Extended Kalman Filter (EKF).

 A non-linear correction is performed using fuzzy logic to join a set of linear correction vectors which are cell-type locally estimated.
}
\examples{
Batches <- SimBatches$batches
Corrected <- Correct_Batches(Batches)
#' z <- Correct_Batches(Batches)
#Corrected <- z$`Batches Integrated`

Uncorrected_PCA <- prcomp(t(cbind(Batches[[1]], Batches[[2]])))
plot(Uncorrected_PCA$x[,1:2])
Corrected_PCA <- prcomp(t(Corrected))
# Corrected_PCA <- prcomp(t(z$`Batches Integrated`))
plot(Corrected_PCA$x[,1:2])

}
